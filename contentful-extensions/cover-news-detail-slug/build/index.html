<!doctype html><head><link href="https://static.contentful.com/app/main-62e0abc7.css" media="all" rel="stylesheet" type="text/css"><link href="https://static.contentful.com/app/vendor-976872d7.css" media="all" rel="stylesheet" type="text/css"><link href="https://contentful.github.io/ui-extensions-sdk/cf-extension.css" media="all" rel="stylesheet" type="text/css"><script type="text/javascript" src="https://unpkg.com/contentful-ui-extensions-sdk@3"></script></head><div class="widget-slug-editor"> news/detail/<input id="slug" type="text" class="form-control" style="width:98%;font-size:14px"> <i id="error" class="fa fa-exclamation-triangle is-slug-duplicate"></i> <i id="ok" class="fa fa-check-circle is-slug-unique"></i> <i id="loading" class="fa fa-spin fa-spinner"></i> </div><script src="https://cdnjs.cloudflare.com/ajax/libs/es6-promise/3.0.2/es6-promise.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/speakingurl/7.0.0/speakingurl.min.js"></script><script>var e=window.contentfulExtension||window.contentfulWidget;e.init((function(e){var n=!0,t=e.field,o=e.contentType.displayField,l=e.entry.fields[o],i=window._,u=window.getSlug,s=i.debounce(r,500),d=document.getElementById("slug"),c={error:document.getElementById("error"),ok:document.getElementById("ok"),loading:document.getElementById("loading")};function a(e){if(console.log("handleSlugChange : "+o+"/"+e),n){var o=t.getValue();g(u(o)),n=!1}else g(u(e||""))}function g(e){console.log("setSlug : "+e),d.value=e,t.setValue(e),f("loading"),s("news/detail/"+e)}function r(n){console.log("updateStatus : "+n),function(n){if(console.log("getDuplicates : "+n),!n)return Promise.resolve(!1);var o={};return o.content_type=e.entry.getSys().contentType.sys.id,o["fields."+t.id]=n,o["sys.id[ne]"]=e.entry.getSys().id,o["sys.publishedAt[exists]"]=!0,e.space.getEntries(o).then((function(e){return e.total>0}))}(n).then((function(e){f(e?"error":"ok")}))}function f(e){console.log("setStatus : "+e),i.each(c,(function(n,t){n.style.display=t===e?"inline":"none"}))}e.window.updateHeight(),l.onValueChanged(a),d.addEventListener("input",(function(){console.log("input"),a(d.value)})),d.addEventListener("change",(function(){console.log("change"),a(d.value)})),r(t.getValue())}));</script>