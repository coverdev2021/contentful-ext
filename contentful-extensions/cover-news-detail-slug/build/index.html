<!doctype html><head><link href="https://static.contentful.com/app/main-62e0abc7.css" media="all" rel="stylesheet" type="text/css"><link href="https://static.contentful.com/app/vendor-976872d7.css" media="all" rel="stylesheet" type="text/css"><link href="https://contentful.github.io/ui-extensions-sdk/cf-extension.css" media="all" rel="stylesheet" type="text/css"><script type="text/javascript" src="https://unpkg.com/contentful-ui-extensions-sdk@3"></script></head><div class="widget-slug-editor"> news/detail/<input id="slug" type="text" class="form-control" style="width:98%;font-size:14px"> <i id="error" class="fa fa-exclamation-triangle is-slug-duplicate"></i> <i id="ok" class="fa fa-check-circle is-slug-unique"></i> <i id="loading" class="fa fa-spin fa-spinner"></i> </div><script src="https://cdnjs.cloudflare.com/ajax/libs/es6-promise/3.0.2/es6-promise.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/speakingurl/7.0.0/speakingurl.min.js"></script><script>var e=window.contentfulExtension||window.contentfulWidget;e.init((function(e){var t=!0,n=e.field,o=e.contentType.displayField,l=(e.entry.fields[o],e.entry.fields.date);e.field.getValue(),console.log("date : "+e.entry.fields.date.getValue());var s=window._,a=window.getSlug,i=s.debounce(u,500),r=document.getElementById("slug"),c={error:document.getElementById("error"),ok:document.getElementById("ok"),loading:document.getElementById("loading")};function g(e){console.log("setSlug : "+e),r.value=e,n.setValue(e),d("loading"),i("news/detail/"+e)}function u(t){console.log("updateStatus : "+t),function(t){if(console.log("getDuplicates : "+t),t=t.replace(/news\/detail\//g,""),console.log("Edit : "+t),!t)return Promise.resolve(!1);var o={};return o.content_type=e.entry.getSys().contentType.sys.id,o["fields."+n.id]=t,o["sys.id[ne]"]=e.entry.getSys().id,o["sys.publishedAt[exists]"]=!0,e.space.getEntries(o).then((function(e){return console.log("RESSSSS"),console.log(e),e.total>0}))}(t).then((function(e){d(e?"error":"ok")}))}function d(e){console.log("setStatus : "+e),s.each(c,(function(t,n){t.style.display=n===e?"inline":"none"}))}function f(e){var t=e.getFullYear(),n=1+e.getMonth(),o=e.getDate(),l=e.getHours(),s=e.getMinutes(),a=e.getSeconds();return n=("0"+n).slice(-2),o=("0"+o).slice(-2),l=("0"+l).slice(-2),s=("0"+s).slice(-2),a=("0"+a).slice(-2),format_str="YYYYMMDD",format_str=format_str.replace(/YYYY/g,t),format_str=format_str.replace(/MM/g,n),format_str=format_str.replace(/DD/g,o),format_str}e.window.updateHeight(),l.onValueChanged((function(e){if(t){var o=n.getValue();if(console.log("handleSlugChange : cslug = "+o+" : value = "+e),o)g(a(o));else{var l=new Date;console.log("init now"),g(f(l))}t=!1}else{console.log("elsevalue : "+e);var s=f(new Date(e));"NaNaNaN"==s?(console.log("NANNNNNN"),g(e)):(console.log("SETTT"),g(s))}})),r.addEventListener("input",(function(){g(r.value)})),r.addEventListener("change",(function(){g(r.value)})),u(n.getValue())}));</script>